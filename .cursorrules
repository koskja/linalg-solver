# Cursor Rules for linalg-solver

You are working on a linear algebra solver Python project that generates LaTeX output for mathematical computations and visualizations.

## Project Context
- **Project**: Linear algebra problem solver with LaTeX output generation
- **Language**: Python 3.12+
- **Dependencies**: SymPy for symbolic mathematics
- **Output**: LaTeX formatted mathematical expressions and matrices
- **venv**: Always use the `.venv` venv.

## Core Requirements

### LaTeX String Formatting
- **No %d in log**: When using `log`, ALWAYS use `%s` for ALL types of arguments
- **ALWAYS use raw strings for LaTeX**: Use `r"..."` prefix for all LaTeX strings
- **NO character escaping needed**: Raw strings eliminate the need to escape backslashes
- **Use percent formatting ONLY**: Use `%s`, `%d`, etc. with the `%` operator
- **NEVER use f-strings or .format()**: Raw strings and percent formatting only
- **SUPER ULTRA NEVER use raw format strings**
- **Examples**:
  ```python
  # ✅ Correct - Raw string with percent formatting
  log(r"\textbf{Matrix $A$:} \[ %s \]", matrix)
  log(r"Eigenvalue $\lambda = %s$ has multiplicity %s", eigenvalue, mult)
  
  # ❌ Wrong - f-strings or .format() with LaTeX
  log(f"\\textbf{{Matrix $A$:}} \\[ {matrix} \\]")  # Don't do this
  log("\\textbf{{Matrix $A$:}} \\[ {} \\]".format(matrix))  # Don't do this
  ```

### Code Style
- Follow PEP 8 conventions
- Use type hints for function parameters and return values
- Prefer descriptive variable names
- Keep functions focused and single-purpose

### Mathematical Operations
- If possible, use "in-house" functions - they log their internal workings
- If the function you need does not exist, there are two options:
  - If there is no logging required, use SymPy.
  - Otherwise, implement the operation yourself with step by step logging
- Handle edge cases (empty matrices, singular matrices, etc.)
- Provide clear mathematical explanations in LaTeX output

### LaTeX Output Guidelines
- Generate clean, readable LaTeX code
- Use appropriate mathematical environments (`\begin{pmatrix}`, `\begin{array}`, etc.)
- Look to `fmt.py` and `res.tex` for common patterns to reuse. If you are using the same pattern multiple times, attempt to abstract it, as in `\StepSim`.
- Include step-by-step mathematical derivations
- Format matrices, vectors, and equations properly
- Use Czech mathematical terminology where appropriate

### Error Handling
- Validate matrix dimensions before operations
- Handle mathematical edge cases gracefully
- Provide meaningful error messages
- Log computation steps even when errors occur

## File Organization
- Keep matrix operations in `linalg_solver/linalg.py`
- Formatting functions in `linalg_solver/fmt.py`
- Logging utilities in `linalg_solver/log.py`
- Main entry point in `main.py`

## Documentation
- Document all public methods with docstrings
- Include mathematical notation in docstrings
- Provide usage examples for complex operations
- Explain algorithm choices and complexity

Remember: Raw strings + percent formatting for ALL LaTeX content. This eliminates escaping headaches and keeps the code clean and readable. 